<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orders - Pratibha Marketing</title>
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#2e3532">

    <!-- Shared CSS -->
    <link rel="stylesheet" href="/assets/css/variables.css">
    <link rel="stylesheet" href="/assets/css/base.css">
    <link rel="stylesheet" href="/assets/css/components.css">
    <link rel="stylesheet" href="/assets/css/utilities.css">
    <link rel="stylesheet" href="/assets/css/responsive.css">

    <!-- Animations -->
    <link rel="stylesheet" href="/assets/css/animations/skeleton.css">
    <link rel="stylesheet" href="/assets/css/animations/cards.css">
    <link rel="stylesheet" href="/assets/css/animations/inputs.css">
    <link rel="stylesheet" href="/assets/css/animations/buttons.css">
    <link rel="stylesheet" href="/assets/css/animations/badges.css">
    <link rel="stylesheet" href="/assets/css/animations/segments.css">
    <link rel="stylesheet" href="/assets/css/animations/page.css">
    <link rel="stylesheet" href="/assets/css/animations/swipe.css">

    <!-- Page-specific styles -->
    <link rel="stylesheet" href="/assets/css/pages/orders.css">
</head>

<body>
    <header class="header header-animated">
        <div class="header-content">
            <a href="/" class="logo">Pratibha <span>Marketing</span></a>
            <div class="header-btns">
                <a href="/pages/order-form/" class="btn-header primary">+ New</a>
                <a href="/" class="btn-header">Home</a>
            </div>
        </div>
    </header>

    <div class="filters-bar" id="filtersBar">
        <div class="segment-control" id="filterSegments" role="tablist" aria-label="Order status filter">
            <div class="segment-indicator" id="segmentIndicator"></div>
            <button class="segment-btn active" data-filter="all" role="tab" aria-selected="true">All</button>
            <button class="segment-btn" data-filter="pending" role="tab" aria-selected="false">Pending</button>
            <button class="segment-btn" data-filter="delivered" role="tab" aria-selected="false">Delivered</button>
            <button class="segment-btn" data-filter="cancelled" role="tab" aria-selected="false">Cancelled</button>
        </div>
    </div>

    <div class="search-bar">
        <input type="text" class="search-input input-animated" placeholder="Search order or customer..."
            id="searchInput" aria-label="Search orders">
    </div>

    <div id="toast" class="toast"></div>

    <div class="orders-list" id="ordersList">
        <!-- Skeleton loading placeholders -->
        <div class="skeleton-card" style="display: flex; align-items: center; gap: 0.875rem;">
            <div class="skeleton" style="width: 48px; height: 48px; border-radius: 12px; flex-shrink: 0;"></div>
            <div style="flex: 1;">
                <div class="skeleton skeleton-text" style="width: 60%; margin-bottom: 0.375rem;"></div>
                <div class="skeleton skeleton-text" style="width: 35%;"></div>
            </div>
            <div class="skeleton" style="width: 70px; height: 32px; border-radius: 20px;"></div>
        </div>
        <div class="skeleton-card" style="display: flex; align-items: center; gap: 0.875rem;">
            <div class="skeleton" style="width: 48px; height: 48px; border-radius: 12px; flex-shrink: 0;"></div>
            <div style="flex: 1;">
                <div class="skeleton skeleton-text" style="width: 70%; margin-bottom: 0.375rem;"></div>
                <div class="skeleton skeleton-text" style="width: 40%;"></div>
            </div>
            <div class="skeleton" style="width: 65px; height: 32px; border-radius: 20px;"></div>
        </div>
        <div class="skeleton-card" style="display: flex; align-items: center; gap: 0.875rem;">
            <div class="skeleton" style="width: 48px; height: 48px; border-radius: 12px; flex-shrink: 0;"></div>
            <div style="flex: 1;">
                <div class="skeleton skeleton-text" style="width: 55%; margin-bottom: 0.375rem;"></div>
                <div class="skeleton skeleton-text" style="width: 30%;"></div>
            </div>
            <div class="skeleton" style="width: 75px; height: 32px; border-radius: 20px;"></div>
        </div>
    </div>

    <!-- Order Detail Modal -->
    <div id="orderModal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title" id="modalTitle">Order Details</div>
                <button class="btn-close" onclick="closeModal()" aria-label="Close dialog">×</button>
            </div>
            <div class="modal-body" id="modalBody"></div>
            <div class="modal-footer" id="modalFooter">
                <button class="btn-modal secondary btn-animated" id="printFromModalBtn" onclick="printFromModal()">
                    <span class="btn-text">Print Invoice</span>
                </button>
                <button class="btn-save-prices btn-animated" id="savePricesBtn" onclick="savePrices()">
                    <span class="btn-text">Save Changes</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Packing Panel (Slide-in from right) -->
    <div id="packingPanel" class="packing-panel">
        <div class="packing-panel-header">
            <div>
                <div class="packing-panel-title" id="packingPanelTitle">Pack Order</div>
                <div class="packing-panel-subtitle" id="packingPanelSubtitle"></div>
            </div>
            <button class="btn-close" onclick="closePackingPanel()" aria-label="Close packing panel">&times;</button>
        </div>

        <div class="packing-panel-progress" id="packingPanelProgress">
            <div class="packing-progress-bar">
                <div class="packing-progress-fill" id="packingProgressFill"></div>
            </div>
            <span class="packing-progress-text" id="packingProgressText">0/0 items</span>
        </div>

        <div class="packing-panel-body" id="packingPanelBody">
            <!-- Packing checklist will be rendered here -->
        </div>

        <div class="packing-panel-issues" id="packingPanelIssues" style="display: none;">
            <h4>Issues</h4>
            <div id="packingIssuesList"></div>
        </div>

        <div class="packing-panel-acknowledgement" id="packingPanelAcknowledgement" style="display: none;">
            <label class="packing-checkbox-label">
                <input type="checkbox" id="packingAcknowledgeCheckbox">
                <span>I confirm all items have been verified and acknowledge any issues listed above</span>
            </label>
        </div>

        <div class="packing-panel-footer">
            <button class="btn-modal primary btn-animated" id="packingCompleteBtn" onclick="completePackingSession()" disabled>
                <span class="btn-text">Complete Packing</span>
            </button>
        </div>
    </div>
    <div id="packingPanelOverlay" class="packing-panel-overlay" onclick="closePackingPanel()"></div>

    <!-- Invoice Modal -->
    <div id="invoiceModal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="invoiceModalTitle">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title" id="invoiceModalTitle">Generate Invoice</div>
                <button class="btn-close" onclick="closeInvoiceModal()" aria-label="Close dialog">×</button>
            </div>
            <div class="modal-body" id="invoiceModalBody">
                <div class="invoice-loading">Loading...</div>
            </div>
            <div class="modal-footer">
                <button class="btn-modal primary btn-animated" id="generateInvoiceBtn" onclick="generateInvoice()"
                    disabled>
                    <span class="btn-text">Download PDF</span>
                </button>
            </div>
        </div>
    </div>

    <script type="module" src="/js/auth.js"></script>
    <script type="module" src="/js/api.js"></script>
    <script type="module" src="/js/pages/orders.js"></script>
</body>

</html>