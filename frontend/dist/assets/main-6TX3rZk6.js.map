{"version":3,"file":"main-6TX3rZk6.js","sources":["../../src/js/pages/dashboard.js"],"sourcesContent":["import { formatCurrency } from '/js/utils.js';\nimport { initPage } from '/js/init.js';\nimport { showToast, createElement } from '/js/ui.js';\n\n// Wait for Auth to be available (with timeout to prevent infinite recursion)\nconst waitForAuth = (attempts = 0) => new Promise((resolve, reject) => {\n    if (window.Auth) {\n        resolve(window.Auth);\n    } else if (attempts > 500) {\n        // 5 second timeout (500 * 10ms)\n        reject(new Error('Auth module failed to load'));\n    } else {\n        setTimeout(() => waitForAuth(attempts + 1).then(resolve).catch(reject), 10);\n    }\n});\n\nlet Auth;\ntry {\n    Auth = await waitForAuth();\n} catch (e) {\n    console.error('Auth initialization failed:', e);\n    window.location.href = '/pages/auth/login.html';\n}\n\n// Initialize page\ninitPage();\n\n// State\nlet rates = [];\nlet procurementData = { toProcure: [], procured: [], categories: [] };\nlet searchQuery = '';\nlet selectedCategory = '';\nconst changedRates = {};\nlet lastQuantities = {}; // Track quantities to detect new orders\nlet pollingInterval = null;\nlet badgeHideTimeout = null; // Track badge hide timeout to prevent overlap\n\n// Sound for new order notifications\nlet audioContext = null;\nlet notificationAudio = null;\nlet soundEnabled = false;\nlet isPolling = false; // Mutex to prevent concurrent polling\n\n// Preload notification sound file\nfunction preloadNotificationSound() {\n    notificationAudio = new Audio('/assets/sounds/notification.wav');\n    notificationAudio.preload = 'auto';\n    notificationAudio.volume = 0.5;\n}\n\n// Cleanup resources on page unload to prevent memory leaks\nwindow.addEventListener('beforeunload', () => {\n    if (pollingInterval) {\n        clearInterval(pollingInterval);\n        pollingInterval = null;\n    }\n    if (audioContext) {\n        audioContext.close().catch(() => {});\n        audioContext = null;\n    }\n    if (notificationAudio) {\n        notificationAudio = null;\n    }\n});\n\n// Pause polling when page is hidden, resume when visible\ndocument.addEventListener('visibilitychange', () => {\n    if (document.hidden) {\n        if (pollingInterval) {\n            clearInterval(pollingInterval);\n            pollingInterval = null;\n        }\n    } else {\n        // Resume polling when page becomes visible again\n        if (!pollingInterval) {\n            startPolling();\n        }\n    }\n});\n\n// Play notification sound - tries audio file first, falls back to Web Audio API\nfunction playNotificationSound() {\n    if (!soundEnabled) return;\n\n    // Try playing the preloaded audio file first\n    if (notificationAudio) {\n        notificationAudio.currentTime = 0;\n        notificationAudio.play().catch(() => {\n            // Fall back to Web Audio API if file playback fails\n            playWebAudioNotification();\n        });\n        return;\n    }\n\n    // Fall back to Web Audio API\n    playWebAudioNotification();\n}\n\n// Web Audio API fallback for notification sound\nfunction playWebAudioNotification() {\n    try {\n        if (!audioContext) {\n            audioContext = new (window.AudioContext || window.webkitAudioContext)();\n        }\n\n        // Resume context if suspended (browser autoplay policy)\n        if (audioContext.state === 'suspended') {\n            audioContext.resume();\n        }\n\n        // Create a pleasant notification sound (two-tone beep)\n        const osc1 = audioContext.createOscillator();\n        const osc2 = audioContext.createOscillator();\n        const gainNode = audioContext.createGain();\n\n        osc1.connect(gainNode);\n        osc2.connect(gainNode);\n        gainNode.connect(audioContext.destination);\n\n        // First tone\n        osc1.frequency.value = 880; // A5\n        osc1.type = 'sine';\n\n        // Second tone (harmony)\n        osc2.frequency.value = 1108.73; // C#6\n        osc2.type = 'sine';\n\n        // Volume envelope\n        const now = audioContext.currentTime;\n        gainNode.gain.setValueAtTime(0, now);\n        gainNode.gain.linearRampToValueAtTime(0.3, now + 0.05);\n        gainNode.gain.linearRampToValueAtTime(0.2, now + 0.15);\n        gainNode.gain.linearRampToValueAtTime(0.3, now + 0.2);\n        gainNode.gain.linearRampToValueAtTime(0, now + 0.35);\n\n        osc1.start(now);\n        osc2.start(now);\n        osc1.stop(now + 0.35);\n        osc2.stop(now + 0.35);\n    } catch (e) {\n        console.log('Could not play notification sound:', e);\n    }\n}\n\n// Elements\nconst printBtn = document.getElementById('printBtn');\nconst exportBtn = document.getElementById('exportBtn');\nconst saveRatesBtn = document.getElementById('saveRatesBtn');\nconst purchaseSearch = document.getElementById('purchaseSearch');\nconst newOrderBadge = document.getElementById('newOrderBadge');\nconst procuredHeader = document.getElementById('procuredHeader');\n\n// Event listeners\nif (printBtn) printBtn.addEventListener('click', printList);\nif (exportBtn) exportBtn.addEventListener('click', exportCSV);\nif (saveRatesBtn) saveRatesBtn.addEventListener('click', saveAllRates);\n\n// Search input\nif (purchaseSearch) {\n    purchaseSearch.addEventListener('input', (e) => {\n        searchQuery = e.target.value.trim().toLowerCase();\n        displayProcurementList();\n    });\n}\n\n// Category filter pills - event delegation for dynamically added pills\nconst categoryPillsContainer = document.getElementById('categoryPills');\nif (categoryPillsContainer) {\n    categoryPillsContainer.addEventListener('click', (e) => {\n        const pill = e.target.closest('.category-pill');\n        if (!pill) return;\n\n        document.querySelectorAll('.category-pill').forEach(p => p.classList.remove('active'));\n        pill.classList.add('active');\n        selectedCategory = pill.dataset.category;\n        displayProcurementList();\n    });\n}\n\n// Populate category pills from API response\nfunction populateCategoryPills(categories) {\n    const container = document.getElementById('categoryPills');\n    if (!container) return;\n\n    // Keep \"All\" button, remove others\n    container.innerHTML = '<button class=\"category-pill active\" data-category=\"\">All</button>';\n\n    // Short display names for categories\n    const displayNames = {\n        'Indian Vegetables': 'Vegetables',\n        'Exotic Vegetables': 'Exotic',\n        'Fruits': 'Fruits',\n        'Frozen': 'Frozen',\n        'Dairy': 'Dairy'\n    };\n\n    categories.forEach(cat => {\n        const pill = createElement('button', {\n            className: 'category-pill' + (selectedCategory === cat ? ' active' : ''),\n            dataset: { category: cat }\n        }, displayNames[cat] || cat);\n        container.appendChild(pill);\n    });\n\n    // Re-select current category if it exists\n    if (selectedCategory) {\n        const currentPill = container.querySelector(`[data-category=\"${selectedCategory}\"]`);\n        if (currentPill) {\n            container.querySelector('.active')?.classList.remove('active');\n            currentPill.classList.add('active');\n        } else {\n            // Category no longer exists, reset to All\n            selectedCategory = '';\n        }\n    }\n}\n\n// Procured section toggle\nif (procuredHeader) {\n    procuredHeader.addEventListener('click', () => {\n        procuredHeader.classList.toggle('collapsed');\n    });\n}\n\n// Initialize sound on first user interaction\nfunction initSound() {\n    if (soundEnabled) return;\n\n    try {\n        // Initialize AudioContext (requires user interaction on mobile)\n        audioContext = new (window.AudioContext || window.webkitAudioContext)();\n        // Preload the notification audio file\n        preloadNotificationSound();\n        soundEnabled = true;\n    } catch (e) {\n        console.log('Could not initialize audio:', e);\n    }\n}\n\n// Enable sound on first click anywhere\ndocument.addEventListener('click', initSound, { once: true });\ndocument.addEventListener('touchstart', initSound, { once: true });\n\nasync function loadDashboardStats() {\n    try {\n        const [ordersRes, productsRes, ratesRes, procurementRes] = await Promise.all([\n            fetch('/api/orders', { credentials: 'include' }),\n            fetch('/api/products', { credentials: 'include' }),\n            fetch('/api/market-rates', { credentials: 'include' }),\n            fetch('/api/supplier/procurement-summary', { credentials: 'include' })\n        ]);\n\n        // Check for auth failures first - redirect to login\n        const allResponses = [ordersRes, productsRes, ratesRes, procurementRes];\n        if (allResponses.some(r => r.status === 401)) {\n            window.location.href = '/pages/auth/login.html';\n            return;\n        }\n\n        // Validate responses before parsing\n        if (!ordersRes.ok || !productsRes.ok || !ratesRes.ok || !procurementRes.ok) {\n            const statuses = { orders: ordersRes.status, products: productsRes.status, rates: ratesRes.status, procurement: procurementRes.status };\n            console.error('Dashboard API failures:', statuses);\n            const failedEndpoint = !ordersRes.ok ? 'orders' :\n                                   !productsRes.ok ? 'products' :\n                                   !ratesRes.ok ? 'rates' : 'procurement';\n            throw new Error(`Failed to load ${failedEndpoint} data (status: ${statuses[failedEndpoint]})`);\n        }\n\n        const orders = await ordersRes.json();\n        const ratesData = await ratesRes.json();\n        const procurementResponse = await procurementRes.json();\n\n        rates = ratesData.data || [];\n        procurementData = {\n            toProcure: procurementResponse.toProcure || [],\n            procured: procurementResponse.procured || [],\n            categories: procurementResponse.categories || []\n        };\n\n        // Populate category filter pills\n        populateCategoryPills(procurementData.categories);\n\n        // Check for new orders\n        detectNewOrders(procurementData);\n\n        // Store current quantities for future comparison\n        storeQuantities(procurementData);\n\n        // Calculate Total Sale (from delivered/completed orders)\n        const ordersList = orders.data || [];\n        const totalSale = ordersList\n            .filter(o => o.status === 'delivered' || o.paymentStatus === 'paid')\n            .reduce((sum, o) => sum + (o.totalAmount || 0), 0);\n\n        // Calculate Profit (estimate based on 15% margin)\n        const profitMargin = 0.15;\n        const totalProfit = totalSale * profitMargin;\n\n        const saleEl = document.getElementById('totalSale');\n        const profitEl = document.getElementById('totalProfit');\n        if (saleEl) saleEl.textContent = formatCurrency(totalSale);\n        if (profitEl) profitEl.textContent = formatCurrency(totalProfit);\n\n        displayProcurementList();\n        loadAnalytics(ordersList);\n\n        // Start polling for new orders\n        startPolling();\n    } catch (error) {\n        console.error('Error loading dashboard stats:', error);\n        const saleEl = document.getElementById('totalSale');\n        const profitEl = document.getElementById('totalProfit');\n        const toProcureEl = document.getElementById('toProcureList');\n        if (saleEl) saleEl.textContent = '—';\n        if (profitEl) profitEl.textContent = '—';\n        if (toProcureEl) {\n            toProcureEl.innerHTML = '';\n            toProcureEl.appendChild(createElement('div', { className: 'empty-state' }, [\n                createElement('p', {}, 'Data not available'),\n                createElement('button', {\n                    id: 'retryBtn',\n                    className: 'btn-retry',\n                    style: { marginTop: '1rem', padding: '0.5rem 1rem', background: 'var(--dusty-olive)', color: 'white', border: 'none', borderRadius: '8px', cursor: 'pointer' },\n                    onclick: loadDashboardStats\n                }, 'Try Again')\n            ]));\n        }\n    }\n}\n\nfunction storeQuantities(data) {\n    lastQuantities = {};\n    [...data.toProcure, ...data.procured].forEach(item => {\n        lastQuantities[item.productId] = item.totalQty;\n    });\n}\n\nfunction detectNewOrders(newData) {\n    if (Object.keys(lastQuantities).length === 0) return; // First load\n\n    let newOrderCount = 0;\n    const allItems = [...newData.toProcure, ...newData.procured];\n\n    allItems.forEach(item => {\n        const prevQty = lastQuantities[item.productId] || 0;\n        if (item.totalQty > prevQty) {\n            newOrderCount++;\n        }\n    });\n\n    if (newOrderCount > 0) {\n        // Play notification sound\n        playNotificationSound();\n\n        // Show badge\n        if (newOrderBadge) {\n            newOrderBadge.textContent = `${newOrderCount} new`;\n            newOrderBadge.classList.remove('hidden');\n\n            // Clear any existing timeout before setting a new one\n            if (badgeHideTimeout) {\n                clearTimeout(badgeHideTimeout);\n            }\n\n            // Auto-hide badge after 30 seconds\n            badgeHideTimeout = setTimeout(() => {\n                if (newOrderBadge) newOrderBadge.classList.add('hidden');\n                badgeHideTimeout = null;\n            }, 30000);\n        }\n\n        showToast(`${newOrderCount} product(s) have new orders!`, 'info');\n    }\n}\n\nfunction startPolling() {\n    if (pollingInterval) clearInterval(pollingInterval);\n\n    // Poll every 30 seconds for new orders\n    pollingInterval = setInterval(async () => {\n        // Mutex to prevent concurrent polling requests\n        if (isPolling) return;\n        isPolling = true;\n\n        try {\n            // Guard: stop polling if page containers no longer exist (user navigated away)\n            if (!document.getElementById('toProcureList')) {\n                clearInterval(pollingInterval);\n                pollingInterval = null;\n                return;\n            }\n\n            const res = await fetch('/api/supplier/procurement-summary', { credentials: 'include' });\n            if (res.status === 401) {\n                clearInterval(pollingInterval);\n                pollingInterval = null;\n                window.location.href = '/pages/auth/login.html';\n                return;\n            }\n            if (!res.ok) {\n                console.warn('Polling failed:', res.status);\n                return;\n            }\n            const data = await res.json();\n\n            if (res.ok) {\n                const newProcurementData = {\n                    toProcure: data.toProcure || [],\n                    procured: data.procured || [],\n                    categories: data.categories || []\n                };\n\n                // Detect new orders before updating\n                detectNewOrders(newProcurementData);\n\n                // Update data\n                procurementData = newProcurementData;\n                storeQuantities(procurementData);\n\n                // Re-render (preserving unsaved rate inputs)\n                displayProcurementList(true);\n            }\n        } catch (error) {\n            console.error('Polling error:', error);\n        } finally {\n            isPolling = false;\n        }\n    }, 30000);\n}\n\nfunction displayProcurementList(preserveInputs = false) {\n    const toProcureContainer = document.getElementById('toProcureList');\n    const procuredContainer = document.getElementById('procuredList');\n    const emptyState = document.getElementById('procurementEmpty');\n    const procuredCountEl = document.getElementById('procuredCount');\n\n    // Guard: abort early if required containers are missing from the DOM\n    if (!toProcureContainer || !procuredContainer) {\n        console.error('Purchase List: Required DOM elements missing (toProcureList or procuredList). Check index.html structure.');\n        const fallback = document.querySelector('.procurement-container');\n        if (fallback) {\n            const existing = fallback.querySelector('.procurement-error');\n            if (!existing) {\n                const errDiv = document.createElement('div');\n                errDiv.className = 'procurement-error';\n                errDiv.style.cssText = 'padding:1.5rem;text-align:center;color:var(--error);font-size:0.875rem;';\n                errDiv.textContent = 'Purchase list failed to load. Please refresh the page.';\n                fallback.appendChild(errDiv);\n            }\n        }\n        return;\n    }\n\n    // Preserve current input values before re-rendering\n    const inputValues = {};\n    if (preserveInputs) {\n        document.querySelectorAll('.item-rate-input').forEach(input => {\n            if (input.value) {\n                inputValues[input.dataset.productId] = input.value;\n            }\n        });\n    }\n\n    // Clear containers\n    toProcureContainer.innerHTML = '';\n    procuredContainer.innerHTML = '';\n\n    // Filter items based on search and category\n    const filterItems = (items) => {\n        return items.filter(item => {\n            const matchesSearch = !searchQuery || item.productName.toLowerCase().includes(searchQuery);\n            const matchesCategory = !selectedCategory || item.category === selectedCategory;\n            return matchesSearch && matchesCategory;\n        });\n    };\n\n    const filteredToProcure = filterItems(procurementData.toProcure);\n    const filteredProcured = filterItems(procurementData.procured);\n\n    // Update procured count\n    if (procuredCountEl) {\n        procuredCountEl.textContent = filteredProcured.length;\n    }\n\n    // Show empty state if nothing to procure\n    if (filteredToProcure.length === 0 && procurementData.toProcure.length === 0) {\n        if (emptyState) emptyState.classList.remove('hidden');\n        toProcureContainer.innerHTML = '<div class=\"empty-list-msg\">No items to procure</div>';\n    } else {\n        if (emptyState) emptyState.classList.add('hidden');\n    }\n\n    // Build rate map for current rates\n    const rateMap = {};\n    rates.forEach(rate => { rateMap[rate.product] = rate; });\n\n    // Render TO PROCURE section\n    if (filteredToProcure.length > 0) {\n        const fragment = document.createDocumentFragment();\n\n        // Add column header\n        fragment.appendChild(createElement('div', { className: 'procurement-column-header' }, [\n            createElement('span', { className: 'col-expand' }),\n            createElement('span', { className: 'col-name' }, 'Product'),\n            createElement('span', { className: 'col-qty' }, 'Qty'),\n            createElement('span', { className: 'col-input' }, 'Rate')\n        ]));\n\n        // Group by category\n        let currentCategory = '';\n        filteredToProcure.forEach(item => {\n            // Category divider\n            if (item.category !== currentCategory) {\n                currentCategory = item.category;\n                fragment.appendChild(createElement('div', { className: 'category-divider' }, currentCategory));\n            }\n\n            const rate = rateMap[item.productId];\n            const currentRate = item.currentRate || rate?.rate || 0;\n            const savedValue = inputValues[item.productId] || '';\n            const unsavedClass = currentRate === 0 ? ' unsaved' : '';\n\n            // Build quantity display based on procurement status\n            let qtyDisplay;\n            if (item.wasProcured) {\n                // Show \"procuredQty + newQty\" format\n                qtyDisplay = createElement('span', { className: 'qty-breakdown' }, [\n                    createElement('span', { className: 'procured-qty' }, String(item.procuredQty || 0)),\n                    createElement('span', { className: 'separator' }, '+'),\n                    createElement('span', { className: 'new-qty highlight-new' }, String(item.newQty || 0))\n                ]);\n            } else {\n                // Show just totalQty\n                qtyDisplay = createElement('span', { className: 'qty-simple' }, String(item.totalQty || 0));\n            }\n\n            // Build details section\n            const detailRows = [\n                createElement('div', { className: 'detail-row' }, [\n                    createElement('span', { className: 'detail-label' }, 'Total Orders'),\n                    createElement('span', { className: 'detail-value' }, item.totalOrders || 0)\n                ])\n            ];\n\n            // Show last rate if previously procured\n            if (item.wasProcured && item.lastRate) {\n                detailRows.unshift(createElement('div', { className: 'detail-row highlight-info' }, [\n                    createElement('span', { className: 'detail-label' }, 'Last Rate'),\n                    createElement('span', { className: 'detail-value' }, `₹${item.lastRate}/${item.unit}`)\n                ]));\n            }\n\n            detailRows.push(\n                createElement('div', { className: 'detail-row' }, [\n                    createElement('span', { className: 'detail-label' }, 'Est. Cost'),\n                    createElement('span', { className: 'detail-value highlight' },\n                        item.totalQty > 0 && currentRate > 0 ? formatCurrency(item.totalQty * currentRate) : '—')\n                ]),\n                createElement('div', { className: 'detail-row' }, [\n                    createElement('span', { className: 'detail-label' }, 'Trend'),\n                    createElement('span', { className: 'detail-value' },\n                        item.trend === 'up' ? '↑ Up' : item.trend === 'down' ? '↓ Down' : '— Stable')\n                ])\n            );\n\n            const procurementItem = createElement('div', {\n                className: `procurement-item${unsavedClass}${item.wasProcured ? ' was-procured' : ''}`,\n                dataset: { productId: item.productId }\n            }, [\n                createElement('div', {\n                    className: 'item-main',\n                    onclick: (e) => window.toggleExpand(e.currentTarget)\n                }, [\n                    createElement('span', { className: 'item-expand' }, '▶'),\n                    createElement('span', { className: 'item-name' }, item.productName),\n                    qtyDisplay,\n                    createElement('span', { className: 'item-unit' }, item.unit),\n                    createElement('input', {\n                        type: 'number',\n                        className: 'item-rate-input' + (savedValue ? ' changed' : ''),\n                        dataset: {\n                            productId: item.productId,\n                            productName: item.productName,\n                            currentRate: currentRate,\n                            quantity: item.totalQty || 0,\n                            notProcuredToday: item.rate === undefined ? 'true' : ''\n                        },\n                        placeholder: '₹0',\n                        value: savedValue,\n                        step: '0.01',\n                        min: '0',\n                        onclick: (e) => e.stopPropagation(),\n                        onchange: (e) => window.handleRateChange(e.target),\n                        oninput: (e) => window.handleRateInput(e.target)\n                    })\n                ]),\n                createElement('div', { className: 'item-details' }, detailRows)\n            ]);\n            fragment.appendChild(procurementItem);\n        });\n\n        toProcureContainer.appendChild(fragment);\n    } else if (searchQuery || selectedCategory) {\n        toProcureContainer.innerHTML = '<div class=\"empty-list-msg\">No matching items</div>';\n    }\n\n    // Render PROCURED section\n    if (filteredProcured.length > 0) {\n        const fragment = document.createDocumentFragment();\n\n        // Group by category\n        let currentCategory = '';\n        filteredProcured.forEach(item => {\n            // Category divider\n            if (item.category !== currentCategory) {\n                currentCategory = item.category;\n                fragment.appendChild(createElement('div', { className: 'category-divider' }, currentCategory));\n            }\n\n            const procurementItem = createElement('div', {\n                className: 'procurement-item procured-item',\n                dataset: { productId: item.productId }\n            }, [\n                createElement('div', {\n                    className: 'item-main',\n                    onclick: (e) => window.toggleExpand(e.currentTarget)\n                }, [\n                    createElement('span', { className: 'item-expand' }, '▶'),\n                    createElement('span', { className: 'item-name' }, '✓ ' + item.productName),\n                    createElement('span', { className: 'qty-simple' }, String(item.procuredQty || 0)),\n                    createElement('span', { className: 'item-unit' }, item.unit),\n                    createElement('span', { className: 'procured-rate' }, `₹${item.rate}`)\n                ]),\n                createElement('div', { className: 'item-details' }, [\n                    createElement('div', { className: 'detail-row' }, [\n                        createElement('span', { className: 'detail-label' }, 'Procured At'),\n                        createElement('span', { className: 'detail-value' },\n                            new Date(item.procuredAt).toLocaleTimeString('en-IN', { hour: '2-digit', minute: '2-digit', timeZone: 'Asia/Kolkata' }))\n                    ]),\n                    createElement('div', { className: 'detail-row' }, [\n                        createElement('span', { className: 'detail-label' }, 'Total Orders'),\n                        createElement('span', { className: 'detail-value' }, item.totalOrders || 0)\n                    ]),\n                    createElement('div', { className: 'detail-row' }, [\n                        createElement('span', { className: 'detail-label' }, 'Total Value'),\n                        createElement('span', { className: 'detail-value highlight' }, formatCurrency(item.procuredQty * item.rate))\n                    ]),\n                    createElement('div', { className: 'detail-actions' }, [\n                        createElement('button', {\n                            className: 'btn-undo',\n                            onclick: (e) => {\n                                e.stopPropagation();\n                                window.undoProcurement(item.productId, item.productName);\n                            }\n                        }, 'Undo')\n                    ])\n                ])\n            ]);\n            fragment.appendChild(procurementItem);\n        });\n\n        procuredContainer.appendChild(fragment);\n    }\n}\n\n// Global functions for inline event handlers\nwindow.toggleExpand = function (element) {\n    element.closest('.procurement-item').classList.toggle('expanded');\n};\n\nwindow.handleRateInput = function (input) {\n    const currentRate = parseFloat(input.dataset.currentRate);\n    const newRate = parseFloat(input.value);\n    const notProcuredToday = input.dataset.notProcuredToday === 'true';\n    input.classList.toggle('changed', input.value && (newRate !== currentRate || notProcuredToday));\n};\n\nwindow.handleRateChange = function (input) {\n    const productId = input.dataset.productId;\n    const productName = input.dataset.productName;\n    const currentRate = parseFloat(input.dataset.currentRate);\n    const quantity = parseFloat(input.dataset.quantity) || 0;\n    const newRate = parseFloat(input.value);\n\n    const notProcuredToday = input.dataset.notProcuredToday === 'true';\n    if (input.value && (newRate !== currentRate || notProcuredToday) && newRate > 0) {\n        changedRates[productId] = { product: productId, productName, rate: newRate, previousRate: currentRate, quantity };\n        input.classList.add('changed');\n    } else {\n        delete changedRates[productId];\n        input.classList.remove('changed');\n    }\n\n    if (saveRatesBtn) saveRatesBtn.classList.toggle('show', Object.keys(changedRates).length > 0);\n};\n\n// Undo procurement - move item back to TO PROCURE\nwindow.undoProcurement = async function (productId, productName) {\n    if (!confirm(`Remove ${productName} from procured list?`)) return;\n\n    // Disable undo button to prevent double-click\n    const undoBtn = document.querySelector(`[onclick*=\"undoProcurement('${productId}'\"]`) ||\n                    document.querySelector(`[data-product-id=\"${productId}\"] .undo-btn`);\n    if (undoBtn) { undoBtn.disabled = true; undoBtn.classList.add('btn-loading'); }\n\n    try {\n        const csrfToken = await Auth.ensureCsrfToken();\n        const headers = { 'Content-Type': 'application/json' };\n        if (csrfToken) headers['X-CSRF-Token'] = csrfToken;\n\n        const res = await fetch(`/api/supplier/procure/${productId}`, {\n            method: 'DELETE',\n            credentials: 'include',\n            headers\n        });\n\n        if (!res.ok) {\n            const data = await res.json();\n            showToast(data.message || 'Could not undo', 'error');\n            return;\n        }\n\n        showToast(`${productName} moved back to TO PROCURE`, 'success');\n        loadDashboardStats();\n    } catch (error) {\n        console.error('Error undoing procurement:', error);\n        showToast('Could not undo', 'error');\n        if (undoBtn) { undoBtn.disabled = false; undoBtn.classList.remove('btn-loading'); }\n    }\n};\n\nfunction printList() {\n    // Build print content from data model (not DOM innerHTML) to prevent XSS\n    const escapeHtml = (str) => {\n        if (typeof str !== 'string') return String(str);\n        return str\n            .replace(/&/g, '&amp;')\n            .replace(/</g, '&lt;')\n            .replace(/>/g, '&gt;')\n            .replace(/\"/g, '&quot;')\n            .replace(/'/g, '&#039;');\n    };\n\n    // Filter items based on current search and category\n    const filterItems = (items) => {\n        return items.filter(item => {\n            const matchesSearch = !searchQuery || item.productName.toLowerCase().includes(searchQuery);\n            const matchesCategory = !selectedCategory || item.category === selectedCategory;\n            return matchesSearch && matchesCategory;\n        });\n    };\n\n    const filteredToProcure = filterItems(procurementData.toProcure);\n    const filteredProcured = filterItems(procurementData.procured);\n\n    // Build TO PROCURE rows from data\n    let toProcureRows = '';\n    let currentCategory = '';\n    filteredToProcure.forEach(item => {\n        if (item.category !== currentCategory) {\n            currentCategory = item.category;\n            toProcureRows += `<div class=\"category-header\">${escapeHtml(currentCategory)}</div>`;\n        }\n        // Show procuredQty + newQty if previously procured, else just totalQty\n        const qtyDisplay = item.wasProcured\n            ? `${item.procuredQty || 0} + ${item.newQty || 0}`\n            : `${item.totalQty || 0}`;\n        toProcureRows += `\n            <div class=\"procurement-item\">\n                <span class=\"item-name\">${escapeHtml(item.productName)}</span>\n                <span class=\"qty-breakdown\">${qtyDisplay}</span>\n                <span class=\"item-unit\">${escapeHtml(item.unit)}</span>\n                <span class=\"current-rate\">₹${(item.currentRate || 0).toFixed(0)}</span>\n            </div>`;\n    });\n\n    // Build PROCURED rows from data\n    let procuredRows = '';\n    currentCategory = '';\n    filteredProcured.forEach(item => {\n        if (item.category !== currentCategory) {\n            currentCategory = item.category;\n            procuredRows += `<div class=\"category-header\">${escapeHtml(currentCategory)}</div>`;\n        }\n        procuredRows += `\n            <div class=\"procurement-item procured-item\">\n                <span class=\"item-name\">${escapeHtml(item.productName)}</span>\n                <span class=\"qty-breakdown\">${item.procuredQty || 0}</span>\n                <span class=\"item-unit\">${escapeHtml(item.unit)}</span>\n                <span class=\"procured-rate\">₹${item.rate}</span>\n            </div>`;\n    });\n\n    const printWindow = window.open('', '_blank');\n    if (!printWindow) {\n        showToast('Popup blocked. Please allow popups for this site.', 'error');\n        return;\n    }\n\n    printWindow.document.write(`\n        <html>\n        <head>\n            <title>Purchase List - Pratibha Marketing</title>\n            <style>\n                body { font-family: Arial, sans-serif; padding: 20px; }\n                h1 { font-size: 18px; margin-bottom: 10px; }\n                h2 { font-size: 14px; margin-top: 20px; color: #666; border-bottom: 1px solid #ddd; padding-bottom: 5px; }\n                .date { color: #666; margin-bottom: 20px; }\n                .category-header { font-weight: bold; color: #666; margin: 15px 0 5px; font-size: 12px; text-transform: uppercase; }\n                .procurement-item { padding: 8px 0; border-bottom: 1px solid #eee; display: flex; gap: 10px; align-items: center; }\n                .item-name { font-weight: bold; flex: 1; }\n                .qty-breakdown { font-family: monospace; min-width: 100px; }\n                .item-unit { color: #666; min-width: 50px; }\n                .current-rate { color: #666; min-width: 60px; text-align: right; }\n                .procured-rate { color: #5d7a5f; font-weight: bold; min-width: 60px; text-align: right; }\n                .procured-item .item-name::before { content: '✓ '; color: #5d7a5f; }\n                .empty-msg { color: #999; font-style: italic; padding: 10px 0; }\n            </style>\n        </head>\n        <body>\n            <h1>Purchase List - Pratibha Marketing</h1>\n            <div class=\"date\">${new Date().toLocaleDateString('en-IN', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</div>\n            <h2>TO PROCURE (${filteredToProcure.length} items)</h2>\n            ${toProcureRows || '<div class=\"empty-msg\">No items to procure</div>'}\n            <h2>PROCURED (${filteredProcured.length} items)</h2>\n            ${procuredRows || '<div class=\"empty-msg\">No procured items</div>'}\n        </body>\n        </html>\n    `);\n    printWindow.document.close();\n    printWindow.print();\n}\n\nfunction exportCSV() {\n    const allItems = [...procurementData.toProcure, ...procurementData.procured];\n\n    const headers = ['Category', 'Product', 'Unit', 'Procured Qty', 'New Qty', 'Total Qty', 'Rate', 'Status'];\n    const rows = allItems.map(item => {\n        const status = procurementData.procured.find(p => p.productId === item.productId) ? 'Procured' : 'To Procure';\n        const rate = item.rate || item.currentRate || 0;\n\n        return [\n            `\"${item.category}\"`,\n            `\"${item.productName}\"`,\n            item.unit,\n            item.procuredQty || 0,\n            item.newQty || 0,\n            item.totalQty || item.procuredQty || 0,\n            rate,\n            status\n        ].join(',');\n    });\n\n    const csvContent = [headers.join(','), ...rows].join('\\n');\n    const blob = new Blob([csvContent], { type: 'text/csv' });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `purchase-list-${new Date().toISOString().split('T')[0]}.csv`;\n    a.click();\n    window.URL.revokeObjectURL(url);\n}\n\nasync function saveAllRates() {\n    if (!saveRatesBtn) return;\n    saveRatesBtn.textContent = 'Saving...';\n    saveRatesBtn.disabled = true;\n\n    const failures = [];\n    const successfulProducts = [];\n\n    const headers = { 'Content-Type': 'application/json' };\n    let csrfToken = await Auth.ensureCsrfToken();\n    if (csrfToken) {\n        headers['X-CSRF-Token'] = csrfToken;\n    }\n\n    const entries = Object.entries(changedRates);\n    const BATCH_SIZE = 5;\n\n    for (let i = 0; i < entries.length; i += BATCH_SIZE) {\n        const batch = entries.slice(i, i + BATCH_SIZE);\n\n        const results = await Promise.all(batch.map(async ([productId, rateData]) => {\n            try {\n                // Use the new /api/supplier/procure endpoint which marks as procured AND updates market rate\n                let response = await fetch('/api/supplier/procure', {\n                    method: 'POST',\n                    headers,\n                    credentials: 'include',\n                    body: JSON.stringify({\n                        productId: rateData.product,\n                        rate: rateData.rate,\n                        quantity: rateData.quantity || 0\n                    })\n                });\n\n                // Handle CSRF error with retry\n                if (response.status === 403) {\n                    const errorData = await response.json().catch(() => ({}));\n                    if (errorData.message?.toLowerCase().includes('csrf')) {\n                        csrfToken = await Auth.refreshCsrfToken();\n                        if (csrfToken) {\n                            headers['X-CSRF-Token'] = csrfToken;\n                            response = await fetch('/api/supplier/procure', {\n                                method: 'POST',\n                                headers,\n                                credentials: 'include',\n                                body: JSON.stringify({\n                                    productId: rateData.product,\n                                    rate: rateData.rate,\n                                    quantity: rateData.quantity || 0\n                                })\n                            });\n                        }\n                    } else {\n                        return { productId, success: false, productName: rateData.productName || productId, error: errorData.message || `HTTP ${response.status}` };\n                    }\n                }\n\n                if (!response.ok) {\n                    const errorData = await response.json().catch(() => ({}));\n                    return { productId, success: false, productName: rateData.productName || productId, error: errorData.message || `HTTP ${response.status}` };\n                } else {\n                    return { productId, success: true };\n                }\n            } catch (error) {\n                console.error('Error saving rate:', error);\n                return { productId, success: false, productName: rateData.productName || productId, error: error.message || 'Network error' };\n            }\n        }));\n\n        results.forEach(result => {\n            if (result.success) {\n                successfulProducts.push(result.productId);\n            } else {\n                failures.push({ productName: result.productName, error: result.error });\n            }\n        });\n    }\n\n    // Only clear successful rates from changedRates\n    for (const productId of successfulProducts) {\n        delete changedRates[productId];\n    }\n\n    saveRatesBtn.textContent = 'Save';\n    saveRatesBtn.disabled = false;\n\n    if (failures.length > 0) {\n        showToast(`${failures.length} rate(s) not saved. Try again.`, 'info');\n        if (Object.keys(changedRates).length > 0) {\n            saveRatesBtn.classList.add('show');\n        } else {\n            saveRatesBtn.classList.remove('show');\n        }\n    } else {\n        saveRatesBtn.classList.remove('show');\n        document.querySelectorAll('.item-rate-input').forEach(input => {\n            input.value = '';\n            input.classList.remove('changed');\n        });\n        showToast('Items marked as procured!', 'success');\n    }\n\n    loadDashboardStats();\n}\n\nasync function checkAPIHealth() {\n    const apiDot = document.getElementById('apiDot');\n    const apiStatus = document.getElementById('apiStatus');\n    if (!apiDot || !apiStatus) return;\n\n    try {\n        const response = await fetch('/api/health');\n        const data = await response.json();\n\n        if (data.status === 'ok') {\n            apiDot.classList.remove('offline');\n            apiStatus.textContent = 'API Online';\n        } else {\n            apiDot.classList.add('offline');\n            apiStatus.textContent = 'API Offline';\n        }\n    } catch (_error) {\n        apiDot.classList.add('offline');\n        apiStatus.textContent = 'API Offline';\n    }\n}\n\n// Analytics Charts\nlet orderStatusChart = null;\nlet revenueChart = null;\nlet topProductsChart = null;\n\nconst chartColors = {\n    olive: 'rgb(126, 145, 129)',\n    oliveLight: 'rgba(126, 145, 129, 0.2)',\n    gunmetal: 'rgb(46, 53, 50)',\n    terracotta: 'rgb(196, 167, 125)',\n    success: 'rgb(93, 122, 95)',\n    warning: 'rgb(184, 154, 90)',\n    error: 'rgb(154, 101, 101)',\n    slate: 'rgb(199, 206, 219)'\n};\n\nasync function loadAnalytics(ordersList) {\n    if (!window.Chart) {\n        // Charts library unavailable - show fallback message in chart containers\n        const chartIds = ['orderStatusChart', 'revenueChart', 'topProductsChart'];\n        chartIds.forEach(id => {\n            const canvas = document.getElementById(id);\n            if (canvas && canvas.parentElement) {\n                const msg = document.createElement('div');\n                msg.style.cssText = 'display:flex;align-items:center;justify-content:center;height:100%;color:var(--dusty-olive);font-size:0.85rem;';\n                msg.textContent = 'Charts unavailable';\n                canvas.parentElement.replaceChild(msg, canvas);\n            }\n        });\n        return;\n    }\n\n    try {\n        // Order Status Distribution (simplified: pending, confirmed, delivered, cancelled)\n        const statusCounts = {\n            pending: 0, confirmed: 0, delivered: 0, cancelled: 0\n        };\n\n        ordersList.forEach(order => {\n            if (Object.hasOwn(statusCounts, order.status)) {\n                statusCounts[order.status]++;\n            }\n        });\n\n        // Update summary counts\n        document.getElementById('pendingCount').textContent = statusCounts.pending;\n        document.getElementById('processingCount').textContent = statusCounts.confirmed;\n        document.getElementById('deliveredCount').textContent = statusCounts.delivered;\n\n        // Order Status Doughnut Chart\n        const statusCtx = document.getElementById('orderStatusChart');\n        if (!statusCtx) {\n            console.warn('Order status chart canvas not found');\n        } else {\n            if (orderStatusChart) orderStatusChart.destroy();\n\n            orderStatusChart = new Chart(statusCtx, {\n                type: 'doughnut',\n                data: {\n                    labels: ['Pending', 'Confirmed', 'Delivered', 'Cancelled'],\n                    datasets: [{\n                        data: [\n                            statusCounts.pending, statusCounts.confirmed,\n                            statusCounts.delivered, statusCounts.cancelled\n                        ],\n                        backgroundColor: [\n                            chartColors.warning, chartColors.olive,\n                            chartColors.success, chartColors.error\n                        ],\n                        borderWidth: 0\n                    }]\n                },\n                options: {\n                    responsive: true,\n                    maintainAspectRatio: false,\n                    cutout: '60%',\n                    plugins: { legend: { display: false } }\n                }\n            });\n        }\n\n        // Revenue Trend (Last 7 Days)\n        const last7Days = [];\n        const revenueByDay = {};\n\n        for (let i = 6; i >= 0; i--) {\n            const date = new Date();\n            date.setDate(date.getDate() - i);\n            const dateStr = date.toISOString().split('T')[0];\n            last7Days.push(dateStr);\n            revenueByDay[dateStr] = 0;\n        }\n\n        ordersList.forEach(order => {\n            if (order.status !== 'cancelled') {\n                const orderDate = new Date(order.createdAt).toISOString().split('T')[0];\n                if (Object.hasOwn(revenueByDay, orderDate)) {\n                    revenueByDay[orderDate] += order.totalAmount || 0;\n                }\n            }\n        });\n\n        const revenueData = last7Days.map(date => revenueByDay[date]);\n        const weekTotal = revenueData.reduce((sum, val) => sum + val, 0);\n        const avgDaily = weekTotal / 7;\n\n        document.getElementById('weekTotal').textContent = formatCurrency(weekTotal);\n        document.getElementById('avgDaily').textContent = formatCurrency(Math.round(avgDaily));\n\n        const revenueCtx = document.getElementById('revenueChart');\n        if (!revenueCtx) {\n            console.warn('Revenue chart canvas not found');\n        } else {\n            if (revenueChart) revenueChart.destroy();\n\n            revenueChart = new Chart(revenueCtx, {\n                type: 'line',\n                data: {\n                    labels: last7Days.map(d => {\n                        const date = new Date(d);\n                        return date.toLocaleDateString('en-IN', { weekday: 'short' });\n                    }),\n                    datasets: [{\n                        label: 'Revenue',\n                        data: revenueData,\n                        borderColor: chartColors.olive,\n                        backgroundColor: chartColors.oliveLight,\n                        fill: true,\n                        tension: 0.4,\n                        pointRadius: 4,\n                        pointBackgroundColor: chartColors.olive\n                    }]\n                },\n                options: {\n                    responsive: true,\n                    maintainAspectRatio: false,\n                    plugins: { legend: { display: false } },\n                    scales: {\n                        y: {\n                            beginAtZero: true,\n                            ticks: { callback: value => '₹' + value.toLocaleString('en-IN') }\n                        }\n                    }\n                }\n            });\n        }\n\n        // Top Products by Quantity\n        const productQuantities = {};\n        ordersList.forEach(order => {\n            if (order.status !== 'cancelled' && order.products) {\n                order.products.forEach(item => {\n                    const name = item.productName || 'Unknown';\n                    productQuantities[name] = (productQuantities[name] || 0) + (item.quantity || 0);\n                });\n            }\n        });\n\n        const sortedProducts = Object.entries(productQuantities)\n            .sort((a, b) => b[1] - a[1])\n            .slice(0, 5);\n\n        const topProductsCtx = document.getElementById('topProductsChart');\n        if (!topProductsCtx) {\n            console.warn('Top products chart canvas not found');\n        } else {\n            if (topProductsChart) topProductsChart.destroy();\n\n            topProductsChart = new Chart(topProductsCtx, {\n                type: 'bar',\n                data: {\n                    labels: sortedProducts.map(([name]) => name.length > 12 ? name.slice(0, 12) + '...' : name),\n                    datasets: [{\n                        label: 'Quantity',\n                        data: sortedProducts.map(([, qty]) => qty),\n                        backgroundColor: [\n                            chartColors.olive, chartColors.terracotta, chartColors.gunmetal,\n                            chartColors.success, chartColors.warning\n                        ],\n                        borderRadius: 4\n                    }]\n                },\n                options: {\n                    responsive: true,\n                    maintainAspectRatio: false,\n                    indexAxis: 'y',\n                    plugins: { legend: { display: false } },\n                    scales: { x: { beginAtZero: true } }\n                }\n            });\n        }\n\n    } catch (error) {\n        console.error('Error loading analytics:', error);\n    }\n}\n\n// ====================\n// LEDGER REPORT\n// ====================\nlet ledgerCustomers = [];\n\nasync function loadLedgerCustomers() {\n    try {\n        const res = await fetch('/api/customers', { credentials: 'include' });\n        const data = await res.json();\n        if (res.ok) {\n            ledgerCustomers = data.data || [];\n            const select = document.getElementById('ledgerCustomer');\n            select.innerHTML = '';\n            select.appendChild(createElement('option', { value: '' }, 'All Customers'));\n            ledgerCustomers.forEach(c => {\n                select.appendChild(createElement('option', { value: c._id }, c.name));\n            });\n        }\n    } catch (e) {\n        console.error('Error loading customers:', e);\n    }\n}\n\nwindow.openLedgerModal = function () {\n    // Load customers if not loaded\n    if (ledgerCustomers.length === 0) {\n        loadLedgerCustomers();\n    }\n    // Set default dates (current month)\n    const now = new Date();\n    const firstDay = new Date(now.getFullYear(), now.getMonth(), 1);\n    document.getElementById('ledgerFromDate').value = firstDay.toISOString().split('T')[0];\n    document.getElementById('ledgerToDate').value = now.toISOString().split('T')[0];\n\n    document.getElementById('ledgerModal').classList.add('show');\n    document.body.style.overflow = 'hidden';\n};\n\nwindow.closeLedgerModal = function () {\n    document.getElementById('ledgerModal').classList.remove('show');\n    document.body.style.overflow = '';\n};\n\nwindow.downloadLedger = async function () {\n    const customerId = document.getElementById('ledgerCustomer').value;\n    const fromDate = document.getElementById('ledgerFromDate').value;\n    const toDate = document.getElementById('ledgerToDate').value;\n\n    // Build query params\n    const params = new URLSearchParams();\n    if (customerId) params.append('customerId', customerId);\n    if (fromDate) params.append('fromDate', fromDate);\n    if (toDate) params.append('toDate', toDate);\n\n    // Find and disable the download button during the operation\n    const downloadBtn = document.querySelector('#ledgerModal .btn-download, #ledgerModal button[onclick*=\"downloadLedger\"]');\n    if (downloadBtn) {\n        downloadBtn.disabled = true;\n        downloadBtn.classList.add('btn-loading');\n    }\n\n    try {\n        showToast('Downloading ledger...', 'info');\n\n        const res = await fetch(`/api/reports/ledger?${params}`, {\n            credentials: 'include'\n        });\n\n        if (!res.ok) {\n            const error = await res.json();\n            throw new Error(error.message || 'Ledger temporarily unavailable');\n        }\n\n        const blob = await res.blob();\n        const url = window.URL.createObjectURL(blob);\n\n        // Get filename from header or generate\n        const disposition = res.headers.get('Content-Disposition');\n        let filename = 'ledger.xlsx';\n        if (disposition && disposition.includes('filename=')) {\n            filename = disposition.split('filename=')[1].replace(/\"/g, '');\n        }\n\n        const a = document.createElement('a');\n        a.href = url;\n        a.download = filename;\n        document.body.appendChild(a);\n        a.click();\n        document.body.removeChild(a);\n        window.URL.revokeObjectURL(url);\n\n        showToast('Ledger downloaded!', 'success');\n        window.closeLedgerModal();\n    } catch (e) {\n        console.error('Download ledger error:', e);\n        showToast(e.message || 'Could not download', 'info');\n    } finally {\n        if (downloadBtn) {\n            downloadBtn.disabled = false;\n            downloadBtn.classList.remove('btn-loading');\n        }\n    }\n};\n\nasync function init() {\n    const user = await Auth.requireAuth(['admin', 'staff']);\n    if (!user) return;\n\n    // Staff users have their own dashboard\n    if (user.role === 'staff') {\n        window.location.href = '/pages/staff-dashboard/';\n        return;\n    }\n\n    const userBadge = document.getElementById('userBadge');\n    if (userBadge) {\n        userBadge.textContent = user.name || user.email || 'User';\n        if (user.role === 'admin') {\n            userBadge.style.cursor = 'pointer';\n            userBadge.title = 'Manage Users';\n            userBadge.onclick = () => { window.location.href = '/pages/users/'; };\n        }\n    }\n    loadDashboardStats();\n    checkAPIHealth();\n}\n\ninit();\n"],"names":["waitForAuth","attempts","resolve","reject","Auth","initPage","rates","procurementData","searchQuery","selectedCategory","changedRates","lastQuantities","pollingInterval","badgeHideTimeout","audioContext","notificationAudio","soundEnabled","isPolling","preloadNotificationSound","startPolling","playNotificationSound","playWebAudioNotification","osc1","osc2","gainNode","now","printBtn","exportBtn","saveRatesBtn","purchaseSearch","newOrderBadge","procuredHeader","printList","exportCSV","saveAllRates","displayProcurementList","categoryPillsContainer","pill","p","populateCategoryPills","categories","container","displayNames","cat","createElement","currentPill","initSound","loadDashboardStats","ordersRes","productsRes","ratesRes","procurementRes","r","statuses","failedEndpoint","orders","ratesData","procurementResponse","detectNewOrders","storeQuantities","ordersList","totalSale","o","sum","totalProfit","saleEl","profitEl","formatCurrency","loadAnalytics","error","toProcureEl","data","item","newData","newOrderCount","prevQty","showToast","res","newProcurementData","preserveInputs","toProcureContainer","procuredContainer","emptyState","procuredCountEl","fallback","errDiv","inputValues","input","filterItems","items","matchesSearch","matchesCategory","filteredToProcure","filteredProcured","rateMap","rate","fragment","currentCategory","currentRate","savedValue","unsavedClass","qtyDisplay","detailRows","procurementItem","e","element","newRate","notProcuredToday","productId","productName","quantity","undoBtn","csrfToken","headers","escapeHtml","str","toProcureRows","procuredRows","printWindow","allItems","rows","status","csvContent","blob","url","a","failures","successfulProducts","entries","BATCH_SIZE","i","batch","rateData","response","errorData","result","checkAPIHealth","apiDot","apiStatus","orderStatusChart","revenueChart","topProductsChart","chartColors","id","canvas","msg","statusCounts","order","statusCtx","last7Days","revenueByDay","date","dateStr","orderDate","revenueData","weekTotal","val","avgDaily","revenueCtx","d","value","productQuantities","name","sortedProducts","b","topProductsCtx","qty","ledgerCustomers","loadLedgerCustomers","select","c","firstDay","customerId","fromDate","toDate","params","downloadBtn","disposition","filename","init","user","userBadge"],"mappings":"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"}