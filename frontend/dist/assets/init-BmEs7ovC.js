import{a as i}from"./ui-Bs0uH3rR.js";window.onerror=function(e,o,r,t,n){return console.error("Uncaught error:",e,"at",o,r,t),!0};window.addEventListener("unhandledrejection",function(e){console.error("Unhandled promise rejection:",e.reason),e.preventDefault()});function s(){"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/service-worker.js").then(e=>{console.log("ServiceWorker registered:",e.scope)}).catch(e=>{console.log("ServiceWorker registration failed:",e)})})}function a(){const e=document.cookie.match(/csrf_token=([^;]+)/);return e?e[1]:null}async function u(){localStorage.removeItem("user");const e={"Content-Type":"application/json"},o=a();o&&(e["X-CSRF-Token"]=o);try{await fetch("/api/auth/logout",{method:"POST",headers:e,credentials:"include"})}catch(r){console.error("Logout error:",r)}window.location.href="/login.html"}function l(){document.querySelectorAll("[data-logout], .logout-btn, #logoutBtn").forEach(o=>{o.addEventListener("click",r=>{r.preventDefault(),u()})})}function d(e={}){const{serviceWorker:o=!0,logout:r=!0,modalEscape:t=!0,csrfPreFetch:n=!0}=e;n&&typeof Auth<"u"&&Auth.ensureCsrfToken&&Auth.ensureCsrfToken().catch(c=>console.warn("CSRF pre-fetch failed:",c)),o&&s(),r&&l(),t&&i()}export{d as i,u as l,s as r};
