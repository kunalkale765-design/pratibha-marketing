import"./responsive-D1ZTW0b0.js";/* empty css               *//* empty css                *//* empty css              */const l=document.getElementById("resetForm"),e=document.getElementById("noticeMessage"),c=document.getElementById("passwordToggle"),i=document.getElementById("password");c.addEventListener("click",()=>{const t=i.type==="password"?"text":"password";i.type=t,c.textContent=t==="password"?"◉":"◎"});const p=new URLSearchParams(window.location.search),m=p.get("token");m||(e.textContent="Invalid reset link. Please request a new one.",e.classList.add("error","show"),l.querySelector('button[type="submit"]').disabled=!0);l.addEventListener("submit",async t=>{t.preventDefault();const r=document.getElementById("password").value,u=document.getElementById("confirmPassword").value,s=document.getElementById("resetBtn");if(e.classList.remove("show","error","success"),r!==u){e.textContent="Passwords do not match",e.classList.add("error","show");return}s.classList.add("btn-loading"),s.disabled=!0;try{const o=document.cookie.split("; ").find(d=>d.startsWith("csrf_token=")),w=o?o.split("=")[1]:"",a=await fetch(`/api/auth/reset-password/${m}`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":w},credentials:"include",body:JSON.stringify({password:r})}),n=await a.json();if(a.ok&&n.success)e.textContent="Password reset successful! Redirecting...",e.classList.add("success","show"),s.classList.remove("btn-loading"),s.classList.add("btn-success"),setTimeout(()=>{n.user?.role==="customer"?window.location.href="/pages/order-form/":window.location.href="/"},1500);else throw new Error(n.message||n.errors?.[0]?.msg||"Reset failed")}catch(o){e.textContent=o.message,e.classList.add("error","show"),s.classList.remove("btn-loading"),s.disabled=!1}});
